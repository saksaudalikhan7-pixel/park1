(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7934],{58951:function(e,t,s){Promise.resolve().then(s.bind(s,75387))},75387:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return y}});var a=s(20984),l=s(30208),i=s(92583),r=s(79574),n=s(27853),o=s(38276),d=s(79285),c=s(38074),x=s(36743),u=s(37038),m=s(74269),p=s(66176),h=s(90615),g=s(40189),f=s(40488),j=s(96187),b=s(14252),v=s(26427),N=s(40346),w=s(46665);function y(){let[e,t]=(0,l.useState)([]),[y,S]=(0,l.useState)([]),[C,D]=(0,l.useState)(!0),[z,_]=(0,l.useState)(""),[A,E]=(0,l.useState)("all"),[B,L]=(0,l.useState)("all"),[T,Z]=(0,l.useState)("all"),[F,P]=(0,l.useState)(25),I=(0,w.useRouter)();async function O(){try{D(!0);let{fetchBookingsClient:e}=await s.e(9560).then(s.bind(s,49560)),a=await e("SESSION");a&&a.length,t(a),S(a)}catch(e){console.error(e),p.toast.error("Failed to load bookings: "+e.message)}finally{D(!1)}}return((0,l.useEffect)(()=>{O()},[]),(0,l.useEffect)(()=>{(function(){let t=[...e];if(z){let e=z.toLowerCase();t=t.filter(t=>{var s,a,l,i,r;return(null===(s=t.customerName)||void 0===s?void 0:s.toLowerCase().includes(e))||(null===(a=t.customerEmail)||void 0===a?void 0:a.toLowerCase().includes(e))||(null===(l=t.name)||void 0===l?void 0:l.toLowerCase().includes(e))||(null===(i=t.email)||void 0===i?void 0:i.toLowerCase().includes(e))||(null===(r=t.id)||void 0===r?void 0:r.toString().includes(e))})}if("all"!==A&&(t=t.filter(e=>(e.bookingStatus||e.status)===A.toUpperCase())),t=(0,o.Q)(t,B),"all"!==T){let e="yes"===T;t=t.filter(t=>t.arrived===e)}t.sort((e,t)=>{let s=new Date(e.createdAt||e.created_at||0).getTime();return new Date(t.createdAt||t.created_at||0).getTime()-s}),S(t)})()},[z,A,B,T,e]),C)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):(0,a.jsxs)("div",{className:"p-8 space-y-6",children:[(0,a.jsx)(x.m,{title:"Session Bookings",description:"View and manage all session bookings",breadcrumbs:[{label:"Dashboard",href:"/admin"},{label:"Session Bookings"}],actions:(0,a.jsx)(u.z,{variant:"primary",icon:(0,a.jsx)(h.Z,{size:16}),onClick:()=>I.push("/admin/session-bookings/new"),children:"Create New Booking"})}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-200",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Date"}),(0,a.jsx)(o.f,{value:B,onChange:L})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Status"}),(0,a.jsxs)("select",{value:A,onChange:e=>E(e.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-300 bg-white text-slate-900 text-sm outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"All Statuses"}),(0,a.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,a.jsx)("option",{value:"pending",children:"Pending"}),(0,a.jsx)("option",{value:"cancelled",children:"Cancelled"}),(0,a.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Arrival Status"}),(0,a.jsxs)("select",{value:T,onChange:e=>Z(e.target.value),className:"w-full px-3 py-2 rounded-lg border border-slate-300 bg-white text-slate-900 text-sm outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"all",children:"All"}),(0,a.jsx)("option",{value:"yes",children:"Arrived"}),(0,a.jsx)("option",{value:"no",children:"Not Arrived"})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-slate-700",children:"Show"}),(0,a.jsxs)("select",{value:F,onChange:e=>P(Number(e.target.value)),className:"w-full px-3 py-2 rounded-lg border border-slate-300 bg-white text-slate-900 text-sm outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:25,children:"25 per page"}),(0,a.jsx)("option",{value:50,children:"50 per page"}),(0,a.jsx)("option",{value:100,children:"100 per page"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-slate-200",children:[(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:["Showing ",(0,a.jsx)("span",{className:"font-semibold text-slate-900",children:Math.min(y.length,F)})," of ",(0,a.jsx)("span",{className:"font-semibold text-slate-900",children:y.length})," bookings"]}),(0,a.jsx)(u.z,{variant:"secondary",size:"sm",onClick:function(){_(""),E("all"),L("all"),Z("all")},icon:(0,a.jsx)(g.Z,{size:14}),children:"Reset Filters"})]})]}),(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-left",children:[(0,a.jsx)("thead",{className:"bg-slate-100 border-b-2 border-slate-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-4 text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Booking #"}),(0,a.jsx)("th",{className:"px-6 py-4 text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Customer"}),(0,a.jsx)("th",{className:"px-6 py-4 text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Date"}),(0,a.jsx)("th",{className:"px-6 py-4 text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Time"}),(0,a.jsx)("th",{className:"px-6 py-4 text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Amount"}),(0,a.jsx)("th",{className:"px-6 py-4 text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Payment"}),(0,a.jsx)("th",{className:"px-6 py-4 text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Arrival"}),(0,a.jsx)("th",{className:"px-6 py-4 text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Waiver"}),(0,a.jsx)("th",{className:"px-6 py-4 text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-slate-100",children:0===y.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:9,className:"px-6 py-16",children:(0,a.jsx)(m.u,{icon:(0,a.jsx)(f.Z,{size:48}),title:"No bookings found",description:"Try adjusting your filters or create a new booking to get started",action:(0,a.jsx)(u.z,{variant:"primary",icon:(0,a.jsx)(h.Z,{size:16}),onClick:()=>I.push("/admin/session-bookings/new"),children:"Create First Booking"})})})}):y.slice(0,F).map(e=>(0,a.jsxs)("tr",{className:"hover:bg-blue-50/30 transition-all duration-200",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("span",{className:"text-sm font-bold text-slate-900",children:["#",e.id]})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.customerName||e.name}),(0,a.jsx)("span",{className:"text-xs text-slate-500",children:e.customerEmail||e.email}),(0,a.jsx)("span",{className:"text-xs text-slate-500",children:e.customerPhone||e.phone})]})}),(0,a.jsxs)("td",{className:"px-6 py-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-slate-900",children:(0,r.p6)(e.date)}),(0,a.jsx)("div",{className:"text-xs text-slate-500 mt-0.5",children:new Date(e.date).getFullYear()})]}),(0,a.jsx)("td",{className:"px-6 py-4 text-sm text-slate-900",children:function(e,t){if(!e)return"";let[s,a]=e.split(":").map(Number),l=new Date;l.setHours(s,a,0);let i=new Date(l.getTime()+6e4*t);return"".concat(k(l)," - ").concat(k(i))}(e.time,e.duration||60)}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"text-sm font-bold text-slate-900",children:(0,n.x)(e.amount||0)})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-bold bg-emerald-100 text-emerald-700 border border-emerald-200",children:"Paid"})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)(d.P,{bookingId:e.id,arrived:e.arrived,onToggle:async(e,s)=>{if(t(t=>t.map(t=>String(t.id)===String(e)?{...t,arrived:s,arrived_at:s?new Date().toISOString():null}:t)),(await (0,i.fm)(e.toString(),"session",s)).success)p.toast.success(s?"Marked as arrived":"Marked as not arrived");else throw t(t=>t.map(t=>String(t.id)===String(e)?{...t,arrived:!s,arrived_at:s?null:new Date().toISOString()}:t)),p.toast.error("Failed to update arrival status"),Error("Failed to update arrival status")},type:"session"})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsx)(c.m,{bookingId:e.id,status:e.waiverStatus||e.waiver_status})}),(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(N.default,{href:"/admin/bookings/".concat(e.id),className:"p-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg transition-all",title:"View Details",children:(0,a.jsx)(j.Z,{size:18})}),(0,a.jsx)(N.default,{href:"/admin/bookings/".concat(e.id,"/edit"),className:"p-2 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-all",title:"Edit Booking",children:(0,a.jsx)(b.Z,{size:18})}),(0,a.jsx)("button",{onClick:()=>p.toast.info("Delete functionality disabled for safety"),className:"p-2 text-red-600 hover:text-red-700 hover:bg-red-50 rounded-lg transition-all",title:"Delete Booking",children:(0,a.jsx)(v.Z,{size:18})})]})})]},e.id))})]})})})]})}function k(e){return e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).toLowerCase()}}},function(e){e.O(0,[6176,1844,7108,7115,9069,1744],function(){return e(e.s=58951)}),_N_E=e.O()}]);